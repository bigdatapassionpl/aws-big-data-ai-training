{"paragraphs":[{"text":"%md\nThis notebook uses the K-Means built-in algorithm in Amazon SageMaker to cluster the MNIST data set.","user":"anonymous","dateUpdated":"2018-05-07T12:18:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693197168_705875174","id":"20180507-113957_97275304","dateCreated":"2018-05-07T11:39:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:739","dateFinished":"2018-05-07T12:18:32+0000","dateStarted":"2018-05-07T12:18:32+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>This notebook uses the K-Means built-in algorithm in Amazon SageMaker to cluster the MNIST data set.</p>\n"}]}},{"title":"Import Spark classes","text":"%pyspark\nfrom sagemaker_pyspark import IAMRole\nfrom sagemaker_pyspark.algorithms import KMeansSageMakerEstimator","user":"anonymous","dateUpdated":"2018-05-07T12:07:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1525693168280_1988966784","id":"20180507-113928_1201752212","dateCreated":"2018-05-07T11:39:28+0000","dateStarted":"2018-05-07T12:07:27+0000","dateFinished":"2018-05-07T12:07:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:740"},{"text":"%pyspark\nroleArn = \"arn:aws:iam::ACCOUNT_NUMBER:role/ROLE_NAME\"\nregion = \"us-east-1\"","user":"anonymous","dateUpdated":"2018-05-07T12:07:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693249269_-1792422027","id":"20180507-114049_1530504874","dateCreated":"2018-05-07T11:40:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:741","dateFinished":"2018-05-07T12:07:27+0000","dateStarted":"2018-05-07T12:07:27+0000","results":{"code":"SUCCESS","msg":[]}},{"title":"Load MNIST data set","text":"%pyspark\ntraining_data = spark.read.format(\"libsvm\").option(\"numFeatures\", \"784\").load(\"s3a://sagemaker-sample-data-{}/spark/mnist/train/\".format(region))\n\ntest_data = spark.read.format(\"libsvm\").option(\"numFeatures\", \"784\").load(\"s3a://sagemaker-sample-data-{}/spark/mnist/train/\".format(region))\n","user":"anonymous","dateUpdated":"2018-05-07T12:07:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693249170_-1752792891","id":"20180507-114049_1713993152","dateCreated":"2018-05-07T11:40:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:742","dateFinished":"2018-05-07T12:07:27+0000","dateStarted":"2018-05-07T12:07:27+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693248976_-1482699163","id":"20180507-114048_617541159","dateCreated":"2018-05-07T11:40:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:743","text":"%pyspark\nkmeans_estimator = KMeansSageMakerEstimator(\n    trainingInstanceType=\"ml.m4.xlarge\", trainingInstanceCount=1, \n    endpointInstanceType=\"ml.m4.xlarge\", endpointInitialInstanceCount=1,\n    sagemakerRole=IAMRole(roleArn))\n    \nkmeans_estimator.setK(10)\nkmeans_estimator.setFeatureDim(784)","dateUpdated":"2018-05-07T12:07:27+0000","dateFinished":"2018-05-07T12:07:27+0000","dateStarted":"2018-05-07T12:07:27+0000","title":"Configure training job","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693248783_-1517711313","id":"20180507-114048_603992235","dateCreated":"2018-05-07T11:40:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:744","dateUpdated":"2018-05-07T12:07:27+0000","dateFinished":"2018-05-07T12:17:48+0000","dateStarted":"2018-05-07T12:07:27+0000","title":"Train","results":{"code":"SUCCESS","msg":[]},"text":"%pyspark\nkmeans_model = kmeans_estimator.fit(training_data)"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693248635_-1645447948","id":"20180507-114048_576568837","dateCreated":"2018-05-07T11:40:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:745","dateUpdated":"2018-05-07T12:07:28+0000","dateFinished":"2018-05-07T12:17:49+0000","dateStarted":"2018-05-07T12:07:28+0000","title":"Predict test data set","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------+-------------------+---------------+\n|label|            features|distance_to_cluster|closest_cluster|\n+-----+--------------------+-------------------+---------------+\n|  5.0|(784,[152,153,154...| 1774.0653076171875|            1.0|\n|  0.0|(784,[127,128,129...|   1328.95654296875|            4.0|\n|  4.0|(784,[160,161,162...| 1715.5311279296875|            8.0|\n|  1.0|(784,[158,159,160...|  864.8080444335938|            5.0|\n|  9.0|(784,[208,209,210...|    1347.0849609375|            2.0|\n|  2.0|(784,[155,156,157...| 1669.9178466796875|            7.0|\n|  1.0|(784,[124,125,126...|   1163.47216796875|            9.0|\n|  3.0|(784,[151,152,153...| 1653.0394287109375|            1.0|\n|  1.0|(784,[152,153,154...|  936.4478759765625|            9.0|\n|  4.0|(784,[134,135,161...| 1589.4205322265625|            2.0|\n|  3.0|(784,[123,124,125...|   1575.50537109375|            3.0|\n|  5.0|(784,[216,217,218...|   1617.62158203125|            5.0|\n|  3.0|(784,[143,144,145...| 1628.9407958984375|            3.0|\n|  6.0|(784,[72,73,74,99...|    1432.1884765625|            0.0|\n|  1.0|(784,[151,152,153...|  927.1327514648438|            9.0|\n|  7.0|(784,[211,212,213...|   1333.08544921875|            6.0|\n|  2.0|(784,[151,152,153...| 1600.5699462890625|            7.0|\n|  8.0|(784,[159,160,161...|    1453.7373046875|            1.0|\n|  6.0|(784,[100,101,102...| 1492.3587646484375|            0.0|\n|  9.0|(784,[209,210,211...|   1400.10986328125|            2.0|\n+-----+--------------------+-------------------+---------------+\nonly showing top 20 rows\n\n"}]},"text":"%pyspark\ntransformed_data = kmeans_model.transform(test_data)\ntransformed_data.show()"},{"text":"","user":"anonymous","dateUpdated":"2018-05-07T12:07:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525693236964_-222261766","id":"20180507-114036_1781566097","dateCreated":"2018-05-07T11:40:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:746"}],"name":"Clustering MNIST with the built-in K-Means algorithm in Amazon SageMaker (Python)","id":"2DDQKKAJF","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
